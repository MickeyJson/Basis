# Unity ShaderLab 学习记录
## 基础
### 1.名词解释
* 渲染图元：点、线、面、三角形等等，具体可参考[OPENGL中概念](https://www.jianshu.com/p/6f5c87bb3025)
* 着色器
	* 顶点着色器（Vertex Shader），通常用于实现顶点的空间变换，顶点着色等功能,可编程
	* 曲面细分着色器（Tessellation Shader），用于细分图元,可选着色器
	* 几何着色器（Geometry Shader），执行逐图元的着色操作or产生更多的图元，可选着色器
### 2.渲染流水线的概念以及大致流程？
* 概念：将渲染工作分为多个工作流程，每个工作流程负责相应的内容，快速批量的完成任务
* 流程：并没有十分准确的阶段流程，但部分有关渲染的书籍中将渲染流程大致分为<font color="red">3个概念性阶段</font>
* 概念性阶段大致可分以下3个流程阶段：
	1. <**应用阶段(Application Stage)----CPU**>
		* 由开发者（CPU）主导，我们负责准备数据。例如：相机的位置、模型、光源等等
			* 提高渲染性能：
				* 粗粒度剔除（Culling）。<font color="red">这里是将不需要渲染的物体剔除，不向下一阶段提交这些剔除物体的渲染数据，可以减少渲染压力，当然这个取决于我们的策略</font>
	2. <**几何阶段(Geometry Stage)----GPU**>
		* GPU主导,部分流水线阶段开发者拥有控制权与配置权
			1. 顶点着色器
				* 顶点坐标转换齐次裁剪空间坐标（转换完之后仍然是3维坐标）
				* 透视除法，得到归一化设备(Normalized Device Coordinates,NDC)坐标
				* 这里需要注意的是：OPENGL中NDC坐标z轴分量是[-1,1],DirectX中分量是[0,1]
			2. 曲面细分着色器
			3. 几何着色器
			4. 裁剪
				* 将不在视野范围内的图元舍弃
				* 部分在视野范围内的图元（在视野范围内边界生成新的顶点，视野范围外的顶点舍弃）
				* 完全在视野范围内的图元保留
			5. 屏幕映射
				* 将齐次裁剪空间坐标转换为屏幕空间坐标(2D坐标)
	3. <**光栅化阶段(Rasterizer Stage)----GPU**>
		* GPU主导,开发者可以拥有部分控制权
			1. 三角形设置
			2. 三角形遍历
			3. 片元着色器
			4. 逐片元操作
* 渲染流水线各个流程注解：
	* 应用阶段(Application Stage)：
		* 将数据加载到显存中
		* 设置每个渲染obj的状态（漫反射颜色、高光颜色、纹理、深度图等等），输出渲染图元
			* 网格怎么样去渲染
				* 使用了什么着色器，顶点or片元
				* 材质
				* 光源特性
			* ......
		* Draw Call<font color="red">(每一个DC指向的都是单独的需要绘制的图元)</font>，向GPU发送命令
	* 几何阶段(Geometry Stage)：
		* 该阶段主要与<font color="yellow"><**图元**></font>打交道，例如：决定绘制的图元是什么，要舍弃那些图元，怎么绘制，在哪里绘制等等
		* 坐标转换：从模型空间转换到屏幕空间（顶点坐标转），输出二维顶点坐标、每个顶点对应的深度值、着色等信息，进入下一阶段
	* 光栅化阶段(Rasterizer Stage)：
		* 根据几何极端传递的数据生成屏幕上的像素，并渲染出最后的图形。
		* 主要任务是决定每个图元的哪些像素应该被绘制在屏幕上。需要对几何阶段得到的逐顶点数据（纹理坐标、顶点颜色等）进行插值，在进行逐像素处理。
	* 这里只是分了3个概念大流程，但每个大流程还可以细分为多个小的流程阶段。

	
